#!/bin/bash

sudo docker network create vulnerable --attachable --subnet 10.0.0.0/24
docker pull parrotsec/security:latest
docker pull tleemcjr/metasploitable2:latest
docker pull webgoat/goatandwolf:latest
docker pull bkimminich/juice-shop:latest

HEIGHT=15
WIDTH=40
CHOICE_HEIGHT=4
BACKTITLE="Pentest Lab"
TITLE="Container selection"
MENU="Choose from the following containers:"

parrot()
{
	sudo docker run \
		--name parrot \
		-it \
		--hostname parrot-docker \
		--network vulnerable \
		--ip="10.0.0.2" \
		--env DISPLAY=$DISPLAY \
		-v /dev/shm:/dev/shm \
		--device /dev/snd \
		--device /dev/dri \
		--mount type=bind,src=/tmp/.X11-unix,dst=/tmp/.X11-unix \
		parrotsec/security:latest \
		/bin/bash
	sudo docker start -a parrot
}

metasploitable()
{
	docker run \
		-it \
		--network vulnerable \
		--ip="10.0.0.3" \
		--name metasploitable \
		--hostname metasploitable2-docker \
		tleemcjr/metasploitable2 \
		bash
} # Don't forget to run services.sh in container

juiceshop()
{
	docker run -d \
		--name juiceshop \
		--network vulnerable \
		--ip="10.0.0.6" \
		bkimminich/juice-shop
} # 10.0.0.06:3000

webgoat() {
	docker run -d \
		--name webgoat \
		--network vulnerable \
		--ip="10.0.0.4" \
		-e TZ=$(cat /etc/timezone) \
		webgoat/goatandwolf

	# 10.0.0.4:8080/WebGoat
	# 10.0.0.4:9090/WebWolf
}

OPTIONS=(1 "ParrotSec"
         2 "Metasploitable2"
         3 "OWASP Juiceshop"
         4 "Webgoat"
         6 "Exit")

CHOICE=$(dialog --clear \
                --backtitle "$BACKTITLE" \
                --title "$TITLE" \
                --menu "$MENU" \
                $HEIGHT $WIDTH $CHOICE_HEIGHT \
                "${OPTIONS[@]}" \
                2>&1 >/dev/tty)

clear
case $CHOICE in
1)
	parrot
	;;
2)
	metasploitable
	;;
3)
	juiceshop
	;;
4)
	webgoat
	;;
6)
	;;
esac
